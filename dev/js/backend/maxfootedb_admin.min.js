/**
 * JavaScript Admin Functions - maxfootedb-admin.min.js
 *
 * @author   Jake Evans
 * @category JavaScript
 * @package  Includes/Assets/Js
 * @version  6.0.0
 */

console.log( 'This is the JavaScript Object that holds all PHP Variables for use in the maxfootedb Admin JavaScript file:' );
console.log( maxfooteDbPhpVariables );


// All functions wrapped in jQuery( document ).ready()...
jQuery( document ).ready( function( $ ) {
	'use strict';

	/* BEGINNING SECTION TO CALL ALL FUNCTIONS IN FILE... */

	// Function to display the admin pointer message when entering the Question Mark image with mouse...
	maxfooteDbAdminPointersJavascript();

	// Function that will handle the saving of the user's License Key.
	maxfooteDbPluginPageDashboardSaveKey();

	// This is a function to save a new Vendor entry to the database on the admin side.
	maxfooteDbAdminSaveToDatabase();







	// This is a function to save a new Vendor entry to the database on the admin side.
	function maxfooteDbAdminSaveToDatabase(){

		$( document ).on( 'click', '#maxfoote-admin-save-vendor', function( event ) {

			var vendorname = $('#maxfoote-form-newsite-vendorname').val();
			// TO-DO Shantanu: finish grabbing all the fields


			// TO-DO Shantanu: once grabbed, make sure none of the values are equal to ''


			var data = {
				'action': 'wpbooklist_new_library_action',
				'security': maxfooteDbPhpVariables.adminnonce4,
				'vendorname': vendorname,
				// Add in all additional fields variables from the form
			};



			$.post( ajaxurl, data, function( response ) {




				document.location.reload( true );
			});

			



		});
	}














	//masking();

	function masking(){
		var phoneMask = IMask(
			document.getElementById('maxfoote-form-contactphone'), {
		    mask: '(000) 000-0000'
		});
	}



	// Function that will handle the saving of the user's License Key.
	function maxfooteDbPluginPageDashboardSaveKey() {

		// When the 'Save' button is clicked at the top of the dashboard...
		$( '#maxfoote-extension-genreric-key-dashboard-form-toplevel' ).on( 'submit', function() {

			var license = $( '#maxfoote-extension-genreric-key-dashboard-input-toplevel' ).val();

			// Make Ajax call to get display options.
			var data = {
				'action': 'maxfootedb_save_license_key_action',
				'security': maxfooteDbPhpVariables.adminnonce1,
				'license': license
			};

			console.log(data);

			$.post( ajaxurl, data, function( response ) {

				document.location.reload( true );

			});


			event.preventDefault ? event.preventDefault() : event.returnValue = false;

		});

		// When the 'Save' button is clicked from the plugin's entry...
		$( '#maxfoote-extension-genreric-key-plugins-page-button-toplevel' ).on( 'click', function() {

			var license = $( this ).prev().val();

			// Make Ajax call to get display options.
			var data = {
				'action': 'maxfootedb_save_license_key_action',
				'security': maxfooteDbPhpVariables.adminnonce1,
				'license': license
			};

			console.log(data);

			$.post( ajaxurl, data, function( response ) {

				document.location.reload( true );

			});
			event.preventDefault ? event.preventDefault() : event.returnValue = false;
		});
	}


	/* ENDING SECTION TO CALL ALL FUNCTIONS IN FILE... */

	// Function to display the admin pointer message when entering the Question Mark image with mouse...
	function maxfooteDbAdminPointersJavascript() {

		$( 'body' ).on( 'mouseenter', '.maxfoote-icon-image-question', function() {

			var label = $( this ).attr( 'data-label' );
			var pointer;

			// Switch for which admin message to display
			switch ( label ) {
			case 'book-form-isbn10':
				pointer = $( this ).pointer({
					content: '<h3>' + maxfootePhpVariables.trans135 + '</h3><p class="maxfoote-admin-pointer">' + maxfootePhpVariables.trans173 + '.</p>',
					position: {
						edge: 'right',
						align: 'right'
					}
				});
				break;
			default:
			}

			// Open the pointer on mouseenter.
			pointer.pointer( 'open' );

			// Close the pointer on mouseleave.
			$( 'body' ).on( 'mouseleave', '.maxfoote-icon-image-question', function() {
				pointer.pointer( 'close' );
			});

		});

		$( 'body' ).on( 'mouseenter', '.maxfoote-icon-image-question-with-link', function() {

			var label = $( this ).attr( 'data-label' );
			var pointer;

			// Switch for which admin message to display
			switch ( label ) {
			case 'book-form-libraries':
				pointer = $( this ).pointer({
					content: '<h3>' + maxfootePhpVariables.trans203 + '</h3><p class="maxfoote-admin-pointer">' + maxfootePhpVariables.trans204 + maxfootePhpVariables.SETTINGS_PAGE_URL + maxfootePhpVariables.trans205 + '.</p>',
					position: {
						edge: 'right',
						align: 'right'
					}
				});
				break;
			default:
			}

			// Open the pointer on mouseenter
			pointer.pointer( 'open' );

		});
	}
});
